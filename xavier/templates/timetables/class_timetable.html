{% extends "base.html" %}

{% block title %}{{ title }} - {{ subtitle }} - {{ block.super }}{% endblock %}

{% block extrahead %}
    <script type="text/javascript">
        var URL_APPLY_CLASSTIMETABLE = "{% url 'apply_classtimetable' %}";
        var CLASS_TIMETABLE_URL = "{{ class_timetable_url }}";
        var CLASSROOM_PK = "{{ class.pk }}";
    </script>
    <script type="text/javascript">
        var UPDATE_CLASSSUBJECT_TIME = "{% url 'update_class_subject_time' %}";
    </script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/dropdown_subjects_for_timetable.js">
    </script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/timetables.js"></script>
{% endblock %}

{% block breadcrumb %}{{ block.super }}
    <li>
        <a href="{% url 'list_classes_for_timetables' %}">{% trans 'class timetables'|capfirst %}</a>
        <span class="divider">/</span>
    </li>
    <li class="active">{{ title }} - {{ subtitle }}</li>
{% endblock %}

{% block main %}
<!-- right button -->
<div class="btn-group pull-right">
    <a class="btn btn-info dropdown-toggle" href="#" data-toggle="dropdown">
        <i class="icon-pencil icon-white"></i>
        <span class="caret"></span>
    </a>
    <ul class="dropdown-menu timetable_to_apply" id="change_timetable">
        <li class="disabled"><a href="#">{% trans 'change timetable'|capfirst %}</a></li>
        {% for timetable in timetable_list %}
            <li class="list-timetables"><a href="#" class="timetable_block" data-toggle="popover" id="timetable-{{ timetable.pk }}" data-original-title="{% trans 'choosing timetable' %}" data-content="{% include "timetables/includes/choosing_timetable_for_class.html" %}" data-placement="left">{% if timetable.pk == timetable_pk %}<i class="icon-ok timetables-list-icon"></i><span class="timetable-list-item-chosen"><strong>{{ timetable.name }}</strong></span>{% else %}<span class="timetable-list-item">{{ timetable.name }}</span>{% endif %}</a></li>
        {% endfor %}
        <li class="divider"></li>
        <li>
            <a href="{% url 'add_timetable' %}"><i class="icon-plus timetables-list-icon"></i><span class="add-timetable-item">{% trans 'new'|capfirst %}</span></a>
        </li>
    </ul>
</div>
<!-- end right button -->

<br />
<br />

<table class="table table-bordered table-hover timetable_for_class">
    <thead>
        <tr>
            <th id="{{ class.pk }}">{{ class }}</th>
            {% for abbr, day in days %}
                <th>{{ day }}</th>
            {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% if times %}
        {% for time in times %}
            <tr>
                <td class="timetable_subjects_list time" id="{{ time.time.pk }}">{{ time.time.start }} - {{ time.time.end }}</td>
                {% for class_subject_time_pk, abbr, subject, teacher in time.subjects %}
                    <td class="timetable_subjects_list listing_subjects" {% if class_subject_time_pk %}id="{{ class_subject_time_pk }}"{% endif %}>
                        <a class="dropdown-toggle timetable_subjects" data-toggle="dropdown" data-target="#" id="dLabel" role="button" name="subjects" title="{% trans 'Click to choose a subject' %}" href="#" rel="{{ abbr }}">
                            <div class="caption clearfix subject_chosen">{% if subject %}<strong>{{ subject.name|truncatechars:15 }}</strong><br /><small>({{ teacher.first_name }})</small>{% else %}&nbsp;{% endif %}</div>
                        </a>
                        {% include "subjects/includes/dropdown.html" with li_link="False" %}
                    </td>
                {% endfor %}
            </tr>
        {% endfor %}
        {% endif %}
    </tbody>
</table>
{% endblock %}
